function showCartToast(message,type="success"){const host=document.createElement("div");document.body.prepend(host);const shadow=host.attachShadow({mode:"open"});const toast=document.createElement("div");toast.textContent=message;shadow.appendChild(toast);const style=document.createElement("style");style.textContent=`
    div {
      position: fixed;
      top: 20px;
      right: 20px;
      min-width: 220px;
      max-width: 320px;
      background: ${type === "error" ? "#e74c3c" : "#2ecc71"};
      color: white;
      font-family: sans-serif;
      font-size: 14px;
      padding: 12px 18px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      opacity: 0;
      transform: translateX(120%);
      transition: all 0.4s ease;
      z-index: 1000000;
    }
    div.show {
      opacity: 1;
      transform: translateX(0);
    }
  `;shadow.appendChild(style);setTimeout(()=>toast.classList.add("show"),50);setTimeout(()=>{toast.classList.remove("show");setTimeout(()=>host.remove(),400)},3000)}
function addToCart(productUrl,clean=!1){if(clean){const urlObj=new URL(productUrl);urlObj.search="";productUrl=urlObj.toString()}
let cart=JSON.parse(localStorage.getItem("cart"))||[];const exists=cart.some(item=>item.productUrl===productUrl);if(exists){showCartToast("Ø§Ù„Ù…Ù†ØªØ¬ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„ ÙÙŠ Ø§Ù„Ø¹Ø±Ø¨Ø©!","error");return}
cart.push({productUrl});localStorage.setItem("cart",JSON.stringify(cart));showCartToast("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¨Ø© Ø¨Ù†Ø¬Ø§Ø­!","success")}
function handleAddToCart(event){event.preventDefault();event.stopPropagation();const productUrl=window.location.href;addToCart(productUrl,!0)}
document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".add-to-cart").forEach(btn=>{btn.replaceWith(btn.cloneNode(!0))});document.querySelectorAll(".add-to-cart").forEach(btn=>{btn.addEventListener("click",handleAddToCart)});const couponBtn=document.querySelector(".copy-button");if(couponBtn){couponBtn.addEventListener("click",(e)=>{e.preventDefault();copyCoupon()})}});document.addEventListener("click",function(e){const postCard=e.target.closest(".post-card");if(!postCard)return;const cartButton=e.target.closest(".external-cart-button");if(cartButton){const productUrl=postCard.getAttribute("data-product-url");addToCart(productUrl,!1);e.preventDefault()}});const countryInfo={SA:{symbol:"Ø±.Ø³",name:"Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©"},AE:{symbol:"Ø¯.Ø¥",name:"Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª"},OM:{symbol:"Ø±.Ø¹",name:"Ø¹ÙÙ…Ø§Ù†"},MA:{symbol:"Ø¯.Ù…",name:"Ø§Ù„Ù…ØºØ±Ø¨"},DZ:{symbol:"Ø¯.Ø¬",name:"Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±"},TN:{symbol:"Ø¯.Øª",name:"ØªÙˆÙ†Ø³"}};const exchangeRates={SA:1,AE:1.02,OM:9.74,MA:0.38,DZ:0.028,TN:1.21};document.addEventListener("DOMContentLoaded",()=>{function getCountryName(){const country=localStorage.getItem("Cntry");return countryInfo[country]?.name||"Ø§Ù„Ø¯ÙˆÙ„Ø©"}
function getCurrencySymbol(){const country=localStorage.getItem("Cntry");return countryInfo[country]?.symbol||""}
function formatPrice(num){const n=parseFloat(num);if(isNaN(n))return"";return n.toLocaleString("en-US",{minimumFractionDigits:2})}
const jsonScript=document.getElementById("product-data");let data={countries:{}};if(!jsonScript){console.warn("âš ï¸ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù†ØµØ± product-data ÙÙŠ Ø§Ù„ØµÙØ­Ø© â€” Ø³ÙŠØªÙ… Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø¨Ø¯ÙˆÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬")}else{try{let jsonText=jsonScript.textContent.replace(/,\s*}/g,"}").replace(/,\s*]/g,"]").replace(/:\s*,/g,': null,').replace(/:\s*}/g,': null}').replace(/:\s*]/g,': null]');data=JSON.parse(jsonText)}catch{console.warn("âš ï¸ Ø®Ø·Ø£ ÙÙŠ JSON Ø¯Ø§Ø®Ù„ product-data â€” Ø³ÙŠØªÙ… Ø§Ù„ØªØ¬Ø§Ù‡Ù„ ÙˆØ§Ù„Ù…ØªØ§Ø¨Ø¹Ø©");data={countries:{}}}}
const countryCode=localStorage.getItem("Cntry");const countryData=data.countries?.[countryCode];if(!countryData){console.warn(`âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙˆÙ„Ø© (${countryCode})`);return}
const shippingFeeEl=document.querySelector(".shipping-fee .value");const shippingTimeEl=document.querySelector(".shipping-time .value");const shippingStatusEl=document.querySelector(".country-shipping .value");const shippingLabel=document.querySelector(".country-shipping .label");const availabilityEl=document.querySelector(".product-availability .value");if(shippingLabel)shippingLabel.textContent=`Ø§Ù„Ø´Ø­Ù† Ø¥Ù„Ù‰ ${getCountryName()}:`;const minDays=+countryData["shipping-min-days"]||0;const maxDays=+countryData["shipping-max-days"]||0;const hasShipping=(+countryData["shipping-min-days"]||0)>0||(+countryData["shipping-max-days"]||0)>0;const isGloballyAvailable=Object.values(data.countries).some(c=>{const min=+c["shipping-min-days"]||0;const max=+c["shipping-max-days"]||0;return min>0||max>0});const isAvailable=isGloballyAvailable;const shippingStatusText=hasShipping?"Ù…ØªØ§Ø­":"ØºÙŠØ± Ù…ØªØ§Ø­";const availabilityText=isAvailable?"Ù…ØªÙˆÙØ±":"ØºÙŠØ± Ù…ØªÙˆÙØ±";if(availabilityEl){availabilityEl.textContent=availabilityText;availabilityEl.style.color=isAvailable?"#2e7d32":"#c62828";availabilityEl.style.fontWeight="bold"}
if(shippingStatusEl){shippingStatusEl.textContent=shippingStatusText;shippingStatusEl.style.color=hasShipping?"#2e7d32":"#c62828";shippingStatusEl.style.fontWeight="bold"}
if(!hasShipping||!isAvailable){if(shippingFeeEl)shippingFeeEl.textContent="-";if(shippingTimeEl)shippingTimeEl.textContent="-"}else{const fee=countryData["shipping-fee"];if(shippingFeeEl){if(fee===0){shippingFeeEl.textContent="Ù…Ø¬Ø§Ù†Ø§";shippingFeeEl.style.color="#2e7d32";shippingFeeEl.style.fontWeight="bold"}else if(fee){shippingFeeEl.textContent=`${formatPrice(fee)} ${getCurrencySymbol()}`}else{shippingFeeEl.textContent="-"}}
if(shippingTimeEl){if(minDays&&maxDays){shippingTimeEl.textContent=`${minDays}-${maxDays} Ø£ÙŠØ§Ù…`}else if(minDays&&!maxDays){shippingTimeEl.textContent=`${minDays} Ø£ÙŠØ§Ù…`}else if(!minDays&&maxDays){shippingTimeEl.textContent=`${maxDays} Ø£ÙŠØ§Ù…`}else{shippingTimeEl.textContent="-"}}}
const originalEl=document.querySelector(".price-original");const discountedEl=document.querySelector(".price-discounted");const savingEl=document.querySelector(".price-saving");const discountEl=document.querySelector(".discount-percentage");const original=countryData["price-original"];const discounted=countryData["price-discounted"];const validOriginal=parseFloat(original)||null;const validDiscounted=parseFloat(discounted)||null;if(validOriginal||validDiscounted){const finalOriginal=validOriginal||validDiscounted;const finalDiscounted=validDiscounted&&validDiscounted<finalOriginal?validDiscounted:finalOriginal;if(originalEl&&validOriginal){originalEl.textContent=`${formatPrice(validOriginal)} ${getCurrencySymbol()}`}else if(originalEl){originalEl.textContent=""}
if(discountedEl&&validDiscounted){discountedEl.textContent=`${formatPrice(validDiscounted)} ${getCurrencySymbol()}`}else if(discountedEl){discountedEl.textContent=""}
const diff=finalOriginal-finalDiscounted;if(diff>0){const rate=exchangeRates[countryCode]||1;const diffInSAR=diff*rate;if(diffInSAR<50){if(savingEl)savingEl.innerHTML="";if(discountEl)
discountEl.textContent=`${Math.round((diff / finalOriginal) * 100)}%`}else{const percentage=Math.round((diff/finalOriginal)*100);if(discountEl)discountEl.textContent=`${percentage}%`;if(savingEl){savingEl.innerHTML=`
          <span class="save-label">ÙˆÙØ±:</span>
          <span class="save-amount">${formatPrice(diff)} ${getCurrencySymbol()}</span>
        `;let color="#7f8c8d";if(diffInSAR>=100&&diffInSAR<250)color="#16a085";else if(diffInSAR<400)color="#1abc9c";else if(diffInSAR<600)color="#2ecc71";else if(diffInSAR<900)color="#f1c40f";else if(diffInSAR<1200)color="#e67e22";else if(diffInSAR<1600)color="#c0392b";else if(diffInSAR<2000)color="#f5008b";else if(diffInSAR<3000)color="#8e44ad";else color="#f39c12";savingEl.style.color=color;savingEl.style.fontWeight="bold";savingEl.title=`Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ… (${formatPrice(finalOriginal)}) ÙˆØ§Ù„Ø¬Ø¯ÙŠØ¯ (${formatPrice(finalDiscounted)})`;const saveAmount=savingEl.querySelector(".save-amount");if(diffInSAR>=500&&!saveAmount.querySelector("img")){const fireGif=document.createElement("img");fireGif.classList.add("fire-gif");fireGif.src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj5J9EL4a9cV3VWmcK1ZYD6OYEB-1APv9gggocpaa7jAJXdgvX8Q7QiaAZC9NxcN25f8MTRSYD6SKwT1LSjL0SB1ovJH1SSkRmqH2y3f1NzWGkC0BE-gpj5bTc1OKi3Rfzh44sAAJSvOS5uq7Ut9ETN-V9LgKim0dkmEVmqUWa-2ZGA7FvMAYrVaJgn/w199-h200/fire%20(1).gif";fireGif.alt="ğŸ”¥";function setFireGifSize(fireGif){const isMobile=window.innerWidth<=600;const gifSize=isMobile?18:26;const marginL=isMobile?4:6;fireGif.style.cssText=`
              width: ${gifSize}px;
              height: ${gifSize}px;
              vertical-align: middle;
              margin-left: ${marginL}px;
              display: inline-block;
              object-fit: contain;
              position: relative;
              top: -0.08em;
            `}
setFireGifSize(fireGif);window.addEventListener("resize",()=>setFireGifSize(fireGif));saveAmount.appendChild(fireGif)}}}}}
try{const priceHistory=Array.isArray(countryData["price-history"])?countryData["price-history"]:[];if(!priceHistory.length){const chartCanvas=document.getElementById("priceChart");if(chartCanvas)chartCanvas.parentElement.style.display="none";return}
const merged={};priceHistory.forEach(item=>{if(!merged[item.date])merged[item.date]={total:0,count:0};merged[item.date].total+=item.price;merged[item.date].count+=1});const finalData=Object.entries(merged).map(([date,{total,count}])=>({date,price:+(total/count).toFixed(2)}));const prices=finalData.map(x=>x.price);const dates=finalData.map(x=>x.date);const min=Math.min(...prices);const max=Math.max(...prices);const avg=+(prices.reduce((a,b)=>a+b,0)/prices.length).toFixed(2);const endPrice=prices[prices.length-1];const prevPrice=prices[prices.length-2]||endPrice;const getArrow=(value,compare)=>{if(value>compare)return `<span class="stat-arrow arrow-up">â–²</span>`;if(value<compare)return `<span class="stat-arrow arrow-down">â–¼</span>`;return""};const stats=`
      <div class="price-stats">
        <div class="stat-item current">
          <strong>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ:</strong> ${endPrice} ${getCurrencySymbol()} ${getArrow(endPrice, prevPrice)}
          <small style="font-size:12px;color:#666;">(${(endPrice - prevPrice).toFixed(2)} ${getCurrencySymbol()})</small>
        </div>
        <div class="stat-item"><strong>Ø§Ù„Ù…ØªÙˆØ³Ø·:</strong> ${avg} ${getCurrencySymbol()} ${getArrow(avg, endPrice)}</div>
        <div class="stat-item"><strong>Ø£Ù‚Ù„ Ø³Ø¹Ø±:</strong> ${min} ${getCurrencySymbol()} ${getArrow(min, endPrice)}</div>
        <div class="stat-item"><strong>Ø£Ø¹Ù„Ù‰ Ø³Ø¹Ø±:</strong> ${max} ${getCurrencySymbol()} ${getArrow(max, endPrice)}</div>
      </div>
    `;document.getElementById("priceChart")?.insertAdjacentHTML("afterend",stats);const tooltipEl=document.createElement("div");tooltipEl.id="chart-tooltip";document.body.appendChild(tooltipEl);const externalTooltipHandler=(context)=>{const{chart,tooltip}=context;const el=tooltipEl;if(tooltip.opacity===0){el.style.opacity=0;el.style.display="none";return}
el.style.display="block";el.style.opacity=1;const dataIndex=tooltip.dataPoints[0].dataIndex;const value=tooltip.dataPoints[0].raw;const prev=dataIndex>0?finalData[dataIndex-1].price:value;const diff=+(value-prev).toFixed(2);const percent=prev!==0?((diff/prev)*100).toFixed(1):0;const arrow=diff>0?`<span class="stat-arrow arrow-up">â–²</span>`:diff<0?`<span class="stat-arrow arrow-down">â–¼</span>`:`<span class="stat-arrow">-</span>`;const date=finalData[dataIndex].date;el.innerHTML=`
        <div class="tooltip-line" style="font-weight:bold;">${date}</div>
        <div class="tooltip-line">Ø§Ù„Ø³Ø¹Ø±: ${value} ${getCurrencySymbol()}</div>
        <div class="tooltip-line">Ø§Ù„ØªØºÙŠØ±: ${arrow} ${diff} ${getCurrencySymbol()}</div>
        <div class="tooltip-line">Ø§Ù„Ù†Ø³Ø¨Ø©: ${percent}%</div>
      `;const position=chart.canvas.getBoundingClientRect();const tooltipWidth=160;const pageWidth=window.innerWidth;const chartLeft=position.left+window.pageXOffset;const pointX=chartLeft+tooltip.caretX;if(pointX>pageWidth*0.7){el.style.left=(pointX-tooltipWidth-20)+'px'}else{el.style.left=(pointX+10)+'px'}
el.style.top=position.top+window.pageYOffset+tooltip.caretY-40+'px'};const ctx=document.getElementById("priceChart")?.getContext("2d");if(ctx){new Chart(ctx,{type:"line",data:{labels:dates,datasets:[{label:"Ø§Ù„Ø³Ø¹Ø±",data:finalData.map(d=>d.price),borderColor:"#2c3e50",backgroundColor:"rgba(44,62,80,0.1)",borderWidth:3,pointRadius:4,pointHoverRadius:6,fill:!0,tension:0.2}]},options:{responsive:!0,interaction:{mode:'index',intersect:!1},plugins:{tooltip:{enabled:!1,external:externalTooltipHandler}},scales:{x:{title:{display:!0,text:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}},y:{title:{display:!0,text:`Ø§Ù„Ø³Ø¹Ø± (${getCurrencySymbol()})`}}}}})}}catch(err){console.error("âŒ Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ:",err)}});async function loadSellerBar(){const sellerBarContainer=document.getElementById("seller-bar");if(!sellerBarContainer)return;const labels=Array.from(document.querySelectorAll(".post-labels a"));const storeLabel=labels.map(el=>el.textContent.trim()).find(l=>l.startsWith("store-"));if(!storeLabel){sellerBarContainer.innerHTML="";return}
let feedUrl=`/feeds/posts/default/-/${encodeURIComponent(storeLabel)}?alt=json&max-results=150`;let found=!1;let nextLink=null;const parser=new DOMParser();if(!found){sellerBarContainer.innerHTML=""}
try{while(feedUrl&&!found){const res=await fetch(feedUrl);const data=await res.json();const entries=data.feed.entry||[];for(const entry of entries){const doc=parser.parseFromString(entry.content.$t,"text/html");if(doc.querySelector(".bar")){const sellerBar=doc.querySelector(".bar");sellerBarContainer.innerHTML=sellerBar.outerHTML;const sellerLink=(entry.link||[]).find(l=>l.rel==="alternate")?.href||"#";let buttons=sellerBarContainer.querySelector(".buttons");if(!buttons){buttons=document.createElement("div");buttons.className="buttons";sellerBarContainer.querySelector(".bar").appendChild(buttons)}
buttons.innerHTML=`<a class="button" href="${sellerLink}">Ø§ÙƒØªØ´Ù Ø§Ù„Ù…ØªØ¬Ø±</a>`;found=!0;break}}
if(!found){const links=data.feed.link||[];const next=links.find(l=>l.rel==="next");nextLink=next?next.href:null;feedUrl=nextLink?nextLink+"&alt=json":null}}
if(!found){sellerBarContainer.innerHTML="<p>âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø§Ø¦Ø¹ ÙÙŠ Ø£ÙŠ Ù…Ù†Ø´ÙˆØ±.</p>"}}catch(err){console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø§Ø¦Ø¹:",err);sellerBarContainer.innerHTML="<p>âš ï¸ ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø§Ø¦Ø¹.</p>"}}
loadSellerBar();async function loadSellerProducts(){const container=document.getElementById("seller-products");const pagination=document.getElementById("pagination");const loader=document.getElementById("loader");if(!container||!pagination||!loader)return;const labels=Array.from(document.querySelectorAll(".post-labels a"));const storeLabel=labels.map(el=>el.textContent.trim()).find(l=>l.startsWith("store-"));if(!storeLabel){container.innerHTML="<p>Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªØµÙ†ÙŠÙ Ø§Ù„Ù…ØªØ¬Ø±.</p>";return}
let feedUrl=`/feeds/posts/default/-/${encodeURIComponent(storeLabel)}?alt=json&max-results=150`;const allEntries=[];let nextLink=null;loader.style.display="block";try{while(feedUrl){const res=await fetch(feedUrl);const data=await res.json();const entries=data.feed.entry||[];allEntries.push(...entries);const links=data.feed.link||[];const next=links.find(l=>l.rel==="next");nextLink=next?next.href:null;feedUrl=nextLink?nextLink+"&alt=json":null}
loader.style.display="none";if(!allEntries.length){container.innerHTML="<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø§Ø¦Ø¹</p>";return}
const perPage=60;let currentPage=1;const totalPages=Math.ceil(allEntries.length/perPage);function renderPage(page){currentPage=page;const start=(page-1)*perPage;const end=start+perPage;const pageEntries=allEntries.slice(start,end);container.innerHTML=pageEntries.map(post=>generatePostHTML(post,!0)).join("");if(typeof lazyLoadImages==="function")lazyLoadImages();renderPagination()}
function renderPagination(){pagination.innerHTML="";const maxVisible=10;let startPage=Math.max(1,currentPage-Math.floor(maxVisible/2));let endPage=Math.min(totalPages,startPage+maxVisible-1);for(let i=startPage;i<=endPage;i++){const btn=document.createElement("button");btn.textContent=i;if(i===currentPage)btn.classList.add("active");btn.addEventListener("click",()=>renderPage(i));pagination.appendChild(btn)}}
renderPage(1)}catch(err){console.error("âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:",err);loader.style.display="none";container.innerHTML="<p>âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª.</p>"}}
loadSellerProducts();const $=(s,r=document)=>r.querySelector(s);const $$=(s,r=document)=>[...r.querySelectorAll(s)];const wrapper=document.querySelector('#coupons');function updateExpiryUI(){if(!wrapper)return;$$('.coupon-card').forEach(card=>{const expiryEl=$('.coupon-expiry',card);const diff=new Date(card.dataset.expiry)-Date.now();if(diff<=0){card.classList.add('is-expired');if(!$('.badge-expired',card)){const b=document.createElement('span');b.className='badge-expired';b.textContent='Ø§Ù†ØªÙ‡Ù‰';card.appendChild(b)}
expiryEl.textContent='Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø¹Ø±Ø¶';return}
const d=Math.floor(diff/86400000);const h=Math.floor(diff%86400000/3600000);const m=Math.floor(diff%3600000/60000);const s=Math.floor(diff%60000/1000);expiryEl.textContent=`ÙŠÙ†ØªÙ‡ÙŠ Ø¨Ø¹Ø¯: ${d} ÙŠÙˆÙ… ${h} Ø³Ø§Ø¹Ø© ${m} Ø¯Ù‚ÙŠÙ‚Ø© ${s} Ø«Ø§Ù†ÙŠØ©`})}
function reveal(maskBtn){const card=maskBtn.closest('.coupon-card');const codeEl=$('.coupon-code',card);const copyBtn=$('.btn-copy',card);codeEl.textContent=card.dataset.code;maskBtn.remove();copyBtn.disabled=!1}
async function copyCode(btn){const card=btn.closest('.coupon-card');const code=card.dataset.code;if(!code)return;try{await navigator.clipboard.writeText(code);showFeedback(btn,"ØªÙ… Ø§Ù„Ù†Ø³Ø®")}catch{const ta=document.createElement('textarea');ta.value=code;document.body.appendChild(ta);ta.select();document.execCommand('copy');document.body.removeChild(ta);showFeedback(btn,"ØªÙ… Ø§Ù„Ù†Ø³Ø®")}}
function showFeedback(btnEl,msg){const original=btnEl.textContent;btnEl.textContent=msg;setTimeout(()=>{btnEl.textContent=original},3000)}
if(wrapper){wrapper.addEventListener('click',e=>{if(e.target.classList.contains('coupon-mask'))reveal(e.target);if(e.target.classList.contains('btn-copy')&&!e.target.disabled)copyCode(e.target);});updateExpiryUI();setInterval(updateExpiryUI,1000)}
document.addEventListener("click",function(e){if(e.target.classList.contains("copy-button")){const btnEl=e.target;const container=btnEl.closest(".coupon-container");const codeEl=container.querySelector(".coupon-code");const code=codeEl?codeEl.textContent.trim():"";if(!code)return;if(navigator.clipboard&&navigator.clipboard.writeText){navigator.clipboard.writeText(code).then(()=>showFeedback(btnEl,"ØªÙ… Ø§Ù„Ù†Ø³Ø®")).catch(()=>showFeedback(btnEl,"ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø®!"))}else{const textarea=document.createElement("textarea");textarea.value=code;document.body.appendChild(textarea);textarea.select();try{document.execCommand("copy");showFeedback(btnEl,"ØªÙ… Ø§Ù„Ù†Ø³Ø®")}catch{showFeedback(btnEl,"ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø®!")}
document.body.removeChild(textarea)}}});const container=document.querySelector('.main-image-container');const thumbnails=[...document.querySelectorAll('.thumbnail-container img')];const thumbContainer=document.querySelector('.thumbnail-container');const mainImg=document.getElementById('mainImage');let currentIndex=0;const scrollAmount=240;function applyImageStyle(img){Object.assign(img.style,{objectFit:'contain',backgroundColor:'black',width:'100%',height:'100%'})}
function changeImage(index){if(index===currentIndex)return;currentIndex=index;mainImg.src=thumbnails[index].src;applyImageStyle(mainImg);thumbnails.forEach(img=>img.classList.toggle('active-thumb',img===thumbnails[index]));scrollThumbnailIntoView(index)}
function scrollThumbnailIntoView(index){const thumb=thumbnails[index];const cRect=thumbContainer.getBoundingClientRect();const tRect=thumb.getBoundingClientRect();const isRTL=getComputedStyle(thumbContainer).direction==='rtl';const offset=tRect.left<cRect.left?tRect.left-cRect.left-10:tRect.right>cRect.right?tRect.right-cRect.right+10:0;thumbContainer.scrollLeft+=isRTL?offset:-offset}
document.getElementById('thumbsRight')?.addEventListener('click',()=>thumbContainer.scrollLeft+=scrollAmount);document.getElementById('thumbsLeft')?.addEventListener('click',()=>thumbContainer.scrollLeft-=scrollAmount);document.getElementById('mainImageRightArrow')?.addEventListener('click',()=>changeImage((currentIndex-1+thumbnails.length)%thumbnails.length));document.getElementById('mainImageLeftArrow')?.addEventListener('click',()=>changeImage((currentIndex+1)%thumbnails.length));thumbnails.forEach((img,i)=>img.addEventListener('click',()=>changeImage(i)));changeImage(0);function createModal(){if(document.getElementById("imageModal"))return;document.body.insertAdjacentHTML("beforeend",`
      <div id="imageModal" class="modal">
        <span class="close" onclick="closeModal()">&times;</span>
        <img class="modal-content" id="modalImage" />
        <span class="arrow left" onclick="navigateModal('prev')"></span>
        <span class="arrow right" onclick="navigateModal('next')"></span>
      </div>
    `)}
createModal();const modal=document.getElementById("imageModal");const modalImage=document.getElementById("modalImage");window.openModal=function(index){modal.style.display="flex";modalImage.src=thumbnails[index].src;applyImageStyle(modalImage);currentIndex=index};window.closeModal=function(){modal.style.display="none"};window.navigateModal=function(direction){currentIndex=direction==="next"?(currentIndex+1)%thumbnails.length:(currentIndex-1+thumbnails.length)%thumbnails.length;modalImage.src=thumbnails[currentIndex].src;applyImageStyle(modalImage)};const buyBtn=document.querySelector(".buy-button");if(buyBtn)buyBtn.textContent="Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†";const cartBtn=document.querySelector(".add-to-cart");if(cartBtn)cartBtn.textContent="Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©";const textMap={"Ø§Ù„ÙˆØµÙ":"Ø§Ù„ØªÙØ§ØµÙŠÙ„","Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª":"Ø§Ù„Ù…Ø²Ø§ÙŠØ§","Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª":"Ø§Ù„Ø®ØµØ§Ø¦Øµ Ø§Ù„ÙÙ†ÙŠØ©","Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ø³Ø¹Ø±":"ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±","ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡":"Ø¢Ø±Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†","ÙÙŠØ¯ÙŠÙˆ":"Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ"};document.querySelectorAll(".tab-buttons button").forEach(btn=>{const oldText=btn.textContent.trim();if(textMap[oldText]){btn.textContent=textMap[oldText]}});function renderStars(container){const rating=parseFloat(container.getAttribute("data-rating"))||0;const fullStars=Math.floor(rating);const hasHalf=rating%1!==0?1:0;const emptyStars=5-fullStars-hasHalf;let starsHTML="";for(let i=0;i<fullStars;i++){starsHTML+=`<span class="star">â˜…</span>`}
if(hasHalf){starsHTML+=`<span class="star half">â˜…</span>`}
for(let i=0;i<emptyStars;i++){starsHTML+=`<span class="star empty">â˜…</span>`}
container.innerHTML=starsHTML}
document.querySelectorAll(".stars-group[data-rating]").forEach(renderStars);const ratingValueEl=document.getElementById("ratingValue");if(ratingValueEl){const starsContainer=document.getElementById("stars");starsContainer.setAttribute("data-rating",ratingValueEl.textContent);renderStars(starsContainer)}
const ratingCount=document.getElementById("goToReviews");if(ratingCount){const count=ratingCount.getAttribute("data-count")||"0";ratingCount.textContent=`${count} ØªÙ‚ÙŠÙŠÙ…Ø§Øª`}
let enableInitialScroll=!1;function showTab(id,btn,forceScroll=!1){document.querySelectorAll('[id^="tab"]').forEach(t=>t.style.display='none');document.querySelectorAll('.tab-buttons button').forEach(b=>b.classList.remove('active'));const target=document.getElementById(id);if(target){target.style.display='block';const targetTop=target.getBoundingClientRect().top+window.scrollY;const stickyHeight=document.querySelector('.tab-buttons')?.offsetHeight||0;setTimeout(()=>{if(enableInitialScroll||forceScroll){window.scrollTo({top:targetTop-stickyHeight-10,behavior:'smooth'})}},100)}
if(btn)btn.classList.add('active');}
let tabCheck=setInterval(()=>{const firstBtn=document.querySelector('.tab-buttons button');const firstTab=document.getElementById('tab1');if(firstBtn&&firstTab){showTab('tab1',firstBtn);document.querySelectorAll('.tab-buttons button').forEach(btn=>{btn.addEventListener('click',()=>{const id=btn.getAttribute('onclick')?.match(/'(.*?)'/)?.[1];if(id)showTab(id,btn,!0);})});clearInterval(tabCheck)}},100);setTimeout(()=>clearInterval(tabCheck),5000);const goToReviewsBtn=document.getElementById("goToReviews");if(goToReviewsBtn){goToReviewsBtn.addEventListener("click",function(e){e.preventDefault();const tabButtons=document.querySelectorAll('.tab-buttons button');const targetButton=Array.from(tabButtons).find(btn=>btn.getAttribute('onclick')?.includes("'tab5'"));if(targetButton){showTab('tab5',targetButton,!0);setTimeout(()=>{const reviewsSection=document.getElementById('tab5');if(reviewsSection){reviewsSection.scrollIntoView({behavior:'smooth'})}},300)}})}
const avatarURL="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgwYjQ3P3sS7yC15Dqs4gAPU3sEGpftVMbqMLwaUbIk5lgxsDIxG5LseYewSYgx9ugKh5wI8ZvMZL_Oh2qZd6FD6lvHbSenXP148Iy3AHvflDx8cO6ysEGc3_nOjv4wbs9USnFA2qdgIvy-WX_ybSngrHNRqpuMSACdhRX19hoQztPYC70WNNpU8zEd/w200-h200/6VBx3io.png";document.querySelectorAll(".avatar-placeholder").forEach(placeholder=>{const img=document.createElement("img");img.src=avatarURL;img.alt="Ø£ÙØ§ØªØ§Ø±";img.className="reviewer-img";placeholder.appendChild(img)})
